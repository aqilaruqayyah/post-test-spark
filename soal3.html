<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Post-Test Soal 3 - Kolam Renang</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

    html, body { margin:0; padding:0; font-family:'Poppins',sans-serif; background:#cce7ff; min-height:100vh; }
    body { display:flex; justify-content:center; align-items:flex-start; padding:20px; }

    .soal-box {
      background:#ffffffcc;
      border-radius:20px;
      padding:20px;
      max-width:700px;
      width:100%;
      box-shadow:0 8px 25px rgba(0,0,0,0.2);
      text-align:center;
      position:relative;
    }

    h2 { color:#6a5acd; margin-bottom:10px; }
    p { font-size:1.1em; margin-bottom:15px; }

    model-viewer {
      width:100%; height:300px; border-radius:15px; margin:15px 0; background:#f1f1f1; display:none; transform-origin:top left;
    }

    .input-container {
      display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-bottom:15px;
    }

    .input-container label { font-weight:600; margin-right:5px; }
    .input-container input { width:80px; padding:5px; border-radius:5px; border:1px solid #aaa; }

    #jawaban {
      width:90%; max-width:500px; padding:10px; font-size:16px; border-radius:8px; border:1px solid #aaa; margin-top:15px; display:none;
    }

    button {
      padding:8px 15px; margin-top:10px; background-color:#6a5acd; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600;
    }

    button:hover { background-color:#5841a1; }

    @media (max-width:480px) { model-viewer{height:200px;} .input-container input{width:60px;} }

    /* Chat Button */
    #chatButton {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: url('https://raw.githubusercontent.com/aqilaruqayyah/model-3d/main/geo.jpg') no-repeat center/cover;
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      z-index: 9999;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    #chatButton:hover { transform: translateY(-3px) scale(1.05); box-shadow:0 12px 30px rgba(0,0,0,0.35); }

    #chatModal {
      display:none;
      position: fixed;
      bottom:100px;
      right:20px;
      width:300px;
      max-width:300px;
      height:400px;
      border:2px solid #6a5acd;
      border-radius:15px;
      overflow:hidden;
      z-index:9998;
      background:white;
      box-shadow:0 10px 25px rgba(0,0,0,0.3);
    }

    #chatIframe { width:100%; height:100%; border:none; }
  </style>
</head>
<body>

<div class="soal-box">
  <h2>Soal 3</h2>
  <p>✨ Suatu kolam renang diisi penuh air. Panjang 12 m, lebar 1/3 dari panjang, kedalaman awal 1 m, kedalaman akhir 5 m. Hitung volume air pada kolam tersebut.</p>

  <div class="input-container">
    <div><label>Panjang (m):</label><input type="number" id="panjang" min="0" step="0.1" value="0"></div>
    <div><label>Lebar (m):</label><input type="number" id="lebar" min="0" step="0.1" value="0"></div>
    <div><label>Kedalaman awal (m):</label><input type="number" id="kedalamanAwal" min="0" step="0.1" value="0"></div>
    <div><label>Kedalaman akhir (m):</label><input type="number" id="kedalamanAkhir" min="0" step="0.1" value="0"></div>
    <button id="lihat3D">Lihat Model 3D</button>
  </div>

  <model-viewer id="kolam3d"
                src="https://raw.githubusercontent.com/aqilaruqayyah/model-3d/main/swimming_pool_343.glb"
                alt="Kolam Renang 3D"
                ar
                camera-controls>
  </model-viewer>

  <input type="number" id="jawaban" placeholder="Masukkan volume air (m³)">
  <button id="lanjutSoal">Lanjut ke Soal 4</button>
</div>

<!-- Chat Button -->
<div id="chatButton"></div>
<div id="chatModal">
  <iframe id="chatIframe" src="https://www.chatbase.co/chatbot-iframe/ANlquYKXbQTA8BJfZz5td"></iframe>
</div>

<script>
const btn3D = document.getElementById('lihat3D');
const model = document.getElementById('kolam3d');
const jawabanInput = document.getElementById('jawaban');
const lanjutBtn = document.getElementById('lanjutSoal');

const panjangAsli = 12;
const lebarAsli = 4; 
const kedalamanAwalAsli = 1;
const kedalamanAkhirAsli = 5;

btn3D.addEventListener('click', () => {
  const p = parseFloat(document.getElementById('panjang').value);
  const l = parseFloat(document.getElementById('lebar').value);
  const dAwal = parseFloat(document.getElementById('kedalamanAwal').value);
  const dAkhir = parseFloat(document.getElementById('kedalamanAkhir').value);

  if(p <=0 || l<=0 || dAwal<0 || dAkhir<0){
    alert("Mohon masukkan nilai valid (>0)");
    return;
  }

  model.style.display = 'block';
  model.style.transform = `scale3d(${p/panjangAsli}, ${Math.max(dAwal,dAkhir)/kedalamanAkhirAsli}, ${l/lebarAsli})`;
  jawabanInput.style.display = 'block';
  lanjutBtn.style.display = 'inline-block';
});

// Simpan jawaban ke localStorage
lanjutBtn.addEventListener('click', () => {
  const jawaban = jawabanInput.value.trim();
  const namaSiswa = localStorage.getItem("namaSiswa");
  if(!namaSiswa){
    alert("Nama siswa tidak ditemukan! Kembali ke halaman awal.");
    window.location.href = "index.html";
    return;
  }
  if(!jawaban){
    alert("Jawaban harus diisi!");
    return;
  }

  localStorage.setItem("soal3_jawaban", jawaban);
  window.location.href = "soal4.html";
});

// Chatbot toggle
const chatButton = document.getElementById('chatButton');
const chatModal = document.getElementById('chatModal');
chatButton.addEventListener('click', () => {
  chatModal.style.display = chatModal.style.display==='block'?'none':'block';
});
</script>

</body>
</html>
